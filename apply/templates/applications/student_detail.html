{% extends "applications/base.html" %}

{% block title %}My Application Details{% endblock %}

{% block content %}
<div class="course-details">
    <h2>My Application Details</h2>
    <p><strong>Application ID:</strong> {{ student.code }}</p>
    <p><strong>Full Name:</strong> {{ student.fullname }}</p>
    <p><strong>Email:</strong> {{ student.email }}</p>
    <p><strong>Phone:</strong> {{ student.phone }}</p>
    <p><strong>Gender:</strong> {{ student.get_gender_display }}</p>
    <p><strong>Region:</strong> {{ student.region.name|default:"Not specified" }}</p>
    <p><strong>District:</strong> {{ student.district.name|default:"Not specified" }}</p>

    <h3 style="margin-top: 2rem; margin-bottom: 1rem;">Course Selections</h3>
    {% if student.enrollments.all %}
        <div class="results">
            <table id="result_list">
                <thead>
                    <tr>
                        <th scope="col">Choice</th>
                        <th scope="col">Course Title</th>
                        <th scope="col">Session</th>
                    </tr>
                </thead>
                <tbody>
                    {% for enrollment in student.enrollments.all %}
                    <tr class="{% cycle 'row1' 'row2' %}">
                        <td>{{ forloop.counter }}</td>
                        <td>{{ enrollment.course.title }}</td>
                        <td>{{ enrollment.session.name }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    {% else %}
        <p>You have not selected any courses yet.</p>
    {% endif %}

    <h3 style="margin-top: 2rem; margin-bottom: 1rem;">Application Status</h3>
    <p><strong>Payment Status:</strong> {{ student.user.profile.get_payment_status_display }}</p>

    <div class="details-actions">
        {% if student.user.profile.payment_status != 'APPROVED' %}
            <a href="{% url 'apply:payment' %}" class="btn">Proceed to Payment</a>
        {% elif not student.enrollments.all %}
            <a href="{% url 'apply:course_request' %}" class="btn">Proceed to Course Selection</a>
        {% endif %}
        <a href="{% url 'apply:edit_student' %}" class="btn">Edit Personal Info</a>
    </div>
</div>
{% endblock %}